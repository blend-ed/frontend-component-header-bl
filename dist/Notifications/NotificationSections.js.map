{"version":3,"file":"NotificationSections.js","names":["React","useCallback","useMemo","Button","Spinner","useDispatch","useSelector","useIntl","isEmpty","messages","NotificationRowItem","markAllNotificationsAsRead","selectNotificationsByIds","selectPaginationData","selectSelectedAppName","selectNotificationStatus","splitNotificationsByTime","updatePaginationRequest","RequestStatus","NotificationSections","intl","dispatch","selectedAppName","notificationRequestStatus","notifications","_useSelector","hasMorePages","_useMemo","_useMemo$today","today","_useMemo$earlier","earlier","handleMarkAllAsRead","updatePagination","renderNotificationSection","section","items","createElement","className","formatMessage","notificationTodayHeading","notificationEarlierHeading","length","variant","onClick","notificationMarkAsRead","map","notification","key","id","type","contentUrl","content","courseName","createdAt","lastRead","IN_PROGRESS","animation","size","SUCCESSFUL","loadMoreNotifications","memo"],"sources":["../../src/Notifications/NotificationSections.jsx"],"sourcesContent":["import React, { useCallback, useMemo } from 'react';\nimport { Button, Spinner } from '@edx/paragon';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useIntl } from '@edx/frontend-platform/i18n';\nimport isEmpty from 'lodash/isEmpty';\nimport messages from './messages';\nimport NotificationRowItem from './NotificationRowItem';\nimport { markAllNotificationsAsRead } from './data/thunks';\nimport {\n  selectNotificationsByIds, selectPaginationData, selectSelectedAppName, selectNotificationStatus,\n} from './data/selectors';\nimport { splitNotificationsByTime } from './utils';\nimport { updatePaginationRequest, RequestStatus } from './data/slice';\n\nconst NotificationSections = () => {\n  const intl = useIntl();\n  const dispatch = useDispatch();\n  const selectedAppName = useSelector(selectSelectedAppName());\n  const notificationRequestStatus = useSelector(selectNotificationStatus());\n  const notifications = useSelector(selectNotificationsByIds(selectedAppName));\n  const { hasMorePages } = useSelector(selectPaginationData());\n  const { today = [], earlier = [] } = useMemo(\n    () => splitNotificationsByTime(notifications),\n    [notifications],\n  );\n\n  const handleMarkAllAsRead = useCallback(() => {\n    dispatch(markAllNotificationsAsRead(selectedAppName));\n  }, [dispatch, selectedAppName]);\n\n  const updatePagination = useCallback(() => {\n    dispatch(updatePaginationRequest());\n  }, [dispatch]);\n\n  const renderNotificationSection = (section, items) => {\n    if (isEmpty(items)) { return null; }\n\n    return (\n      <div className=\"pb-2\">\n        <div className=\"d-flex justify-content-between align-items-center py-10px mb-2\">\n          <span className=\"text-gray-500 line-height-10\">\n            {section === 'today' && intl.formatMessage(messages.notificationTodayHeading)}\n            {section === 'earlier' && intl.formatMessage(messages.notificationEarlierHeading)}\n          </span>\n          {notifications?.length > 0 && (section === 'earlier' ? today.length === 0 : true) && (\n            <Button\n              variant=\"link\"\n              className=\"text-info-500 font-size-14 line-height-10 text-decoration-none p-0 border-0\"\n              onClick={handleMarkAllAsRead}\n              data-testid=\"mark-all-read\"\n            >\n              {intl.formatMessage(messages.notificationMarkAsRead)}\n            </Button>\n          )}\n        </div>\n        {items.map((notification) => (\n          <NotificationRowItem\n            key={notification.id}\n            id={notification.id}\n            type={notification.type}\n            contentUrl={notification.contentUrl}\n            content={notification.content}\n            courseName={notification.courseName}\n            createdAt={notification.createdAt}\n            lastRead={notification.lastRead}\n          />\n        ))}\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"mt-4 px-4\" data-testid=\"notification-tray-section\">\n      {renderNotificationSection('today', today)}\n      {renderNotificationSection('earlier', earlier)}\n      {hasMorePages && notificationRequestStatus === RequestStatus.IN_PROGRESS ? (\n        <div className=\"d-flex justify-content-center p-4\">\n          <Spinner animation=\"border\" variant=\"primary\" size=\"lg\" />\n        </div>\n      ) : (hasMorePages && notificationRequestStatus === RequestStatus.SUCCESSFUL\n        && (\n          <Button\n            variant=\"primary\"\n            className=\"w-100 bg-primary-500\"\n            onClick={updatePagination}\n            data-testid=\"load-more-notifications\"\n          >\n            {intl.formatMessage(messages.loadMoreNotifications)}\n          </Button>\n        )\n      )}\n    </div>\n  );\n};\n\nexport default React.memo(NotificationSections);\n"],"mappings":"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"}