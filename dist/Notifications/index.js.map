{"version":3,"file":"index.js","names":["React","useCallback","useEffect","useRef","useState","useDispatch","useSelector","useIntl","classNames","Badge","Icon","IconButton","OverlayTrigger","Popover","NotificationsNone","Settings","selectNotificationTabsCount","resetNotificationState","useIsOnLargeScreen","useIsOnMediumScreen","NotificationTabs","messages","Notifications","intl","dispatch","popoverRef","buttonRef","_useState","_useState2","_slicedToArray","enableNotificationTray","setEnableNotificationTray","notificationCounts","isOnMediumScreen","isOnLargeScreen","hideNotificationTray","prevState","handleClickOutsideNotificationTray","event","_popoverRef$current","_buttonRef$current","current","contains","target","document","addEventListener","removeEventListener","createElement","trigger","key","placement","id","show","overlay","className","ref","Title","as","formatMessage","notificationTitle","src","Content","isActive","alt","onClick","iconAs","variant","iconClassNames","count","pill"],"sources":["../../src/Notifications/index.jsx"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport React, {\n  useCallback, useEffect, useRef, useState,\n} from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useIntl } from '@edx/frontend-platform/i18n';\nimport classNames from 'classnames';\nimport {\n  Badge, Icon, IconButton, OverlayTrigger, Popover,\n} from '@edx/paragon';\nimport { NotificationsNone, Settings } from '@edx/paragon/icons';\nimport { selectNotificationTabsCount } from './data/selectors';\nimport { resetNotificationState } from './data/thunks';\nimport { useIsOnLargeScreen, useIsOnMediumScreen } from './data/hook';\nimport NotificationTabs from './NotificationTabs';\nimport messages from './messages';\n\nconst Notifications = () => {\n  const intl = useIntl();\n  const dispatch = useDispatch();\n  const popoverRef = useRef(null);\n  const buttonRef = useRef(null);\n  const [enableNotificationTray, setEnableNotificationTray] = useState(false);\n  const notificationCounts = useSelector(selectNotificationTabsCount());\n  const isOnMediumScreen = useIsOnMediumScreen();\n  const isOnLargeScreen = useIsOnLargeScreen();\n\n  const hideNotificationTray = useCallback(() => {\n    setEnableNotificationTray(prevState => !prevState);\n  }, []);\n\n  const handleClickOutsideNotificationTray = useCallback((event) => {\n    if (!popoverRef.current?.contains(event.target) && !buttonRef.current?.contains(event.target)) {\n      setEnableNotificationTray(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    document.addEventListener('mousedown', handleClickOutsideNotificationTray);\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutsideNotificationTray);\n      dispatch(resetNotificationState());\n    };\n  }, []);\n\n  return (\n    <OverlayTrigger\n      trigger=\"click\"\n      key=\"bottom\"\n      placement=\"bottom\"\n      id=\"notificationTray\"\n      show={enableNotificationTray}\n      overlay={(\n        <Popover\n          id=\"notificationTray\"\n          data-testid=\"notification-tray\"\n          className={classNames('overflow-auto rounded-0 border-0', {\n            'w-100': !isOnMediumScreen && !isOnLargeScreen,\n            'medium-screen': isOnMediumScreen,\n            'large-screen': isOnLargeScreen,\n          })}\n        >\n          <div ref={popoverRef}>\n            <Popover.Title as=\"h2\" className=\"d-flex justify-content-between p-0 m-4 border-0 text-primary-500 font-size-18 line-height-24\">\n              {intl.formatMessage(messages.notificationTitle)}\n              <Icon src={Settings} className=\"icon-size-20\" data-testid=\"setting-icon\" />\n            </Popover.Title>\n            <Popover.Content className=\"notification-content p-0\">\n              <NotificationTabs />\n            </Popover.Content>\n          </div>\n        </Popover>\n      )}\n    >\n      <div ref={buttonRef}>\n        <IconButton\n          isActive={enableNotificationTray}\n          alt=\"notification bell icon\"\n          onClick={hideNotificationTray}\n          src={NotificationsNone}\n          iconAs={Icon}\n          variant=\"light\"\n          iconClassNames=\"text-primary-500\"\n          className=\"ml-4 mr-1 my-3 notification-button\"\n          data-testid=\"notification-bell-icon\"\n        />\n        {notificationCounts?.count > 0 && (\n          <Badge\n            pill\n            variant=\"danger\"\n            className=\"font-weight-normal px-1 notification-badge\"\n            data-testid=\"notification-count\"\n          >\n            {notificationCounts.count}\n          </Badge>\n        )}\n      </div>\n    </OverlayTrigger>\n  );\n};\n\nexport default Notifications;\n"],"mappings":";;;;;;AAAA;AACA,OAAOA,KAAK,IACVC,WAAW,EAAEC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QACnC,OAAO;AACd,SAASC,WAAW,EAAEC,WAAW,QAAQ,aAAa;AACtD,SAASC,OAAO,QAAQ,6BAA6B;AACrD,OAAOC,UAAU,MAAM,YAAY;AACnC,SACEC,KAAK,EAAEC,IAAI,EAAEC,UAAU,EAAEC,cAAc,EAAEC,OAAO,QAC3C,cAAc;AACrB,SAASC,iBAAiB,EAAEC,QAAQ,QAAQ,oBAAoB;AAChE,SAASC,2BAA2B,QAAQ,kBAAkB;AAC9D,SAASC,sBAAsB,QAAQ,eAAe;AACtD,SAASC,kBAAkB,EAAEC,mBAAmB,QAAQ,aAAa;AACrE,OAAOC,gBAAgB,MAAM,oBAAoB;AACjD,OAAOC,QAAQ,MAAM,YAAY;AAEjC,IAAMC,aAAa,GAAG,SAAhBA,aAAaA,CAAA,EAAS;EAC1B,IAAMC,IAAI,GAAGhB,OAAO,CAAC,CAAC;EACtB,IAAMiB,QAAQ,GAAGnB,WAAW,CAAC,CAAC;EAC9B,IAAMoB,UAAU,GAAGtB,MAAM,CAAC,IAAI,CAAC;EAC/B,IAAMuB,SAAS,GAAGvB,MAAM,CAAC,IAAI,CAAC;EAC9B,IAAAwB,SAAA,GAA4DvB,QAAQ,CAAC,KAAK,CAAC;IAAAwB,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAApEG,sBAAsB,GAAAF,UAAA;IAAEG,yBAAyB,GAAAH,UAAA;EACxD,IAAMI,kBAAkB,GAAG1B,WAAW,CAACU,2BAA2B,CAAC,CAAC,CAAC;EACrE,IAAMiB,gBAAgB,GAAGd,mBAAmB,CAAC,CAAC;EAC9C,IAAMe,eAAe,GAAGhB,kBAAkB,CAAC,CAAC;EAE5C,IAAMiB,oBAAoB,GAAGlC,WAAW,CAAC,YAAM;IAC7C8B,yBAAyB,CAAC,UAAAK,SAAS;MAAA,OAAI,CAACA,SAAS;IAAA,EAAC;EACpD,CAAC,EAAE,EAAE,CAAC;EAEN,IAAMC,kCAAkC,GAAGpC,WAAW,CAAC,UAACqC,KAAK,EAAK;IAAA,IAAAC,mBAAA,EAAAC,kBAAA;IAChE,IAAI,GAAAD,mBAAA,GAACd,UAAU,CAACgB,OAAO,cAAAF,mBAAA,eAAlBA,mBAAA,CAAoBG,QAAQ,CAACJ,KAAK,CAACK,MAAM,CAAC,KAAI,GAAAH,kBAAA,GAACd,SAAS,CAACe,OAAO,cAAAD,kBAAA,eAAjBA,kBAAA,CAAmBE,QAAQ,CAACJ,KAAK,CAACK,MAAM,CAAC,GAAE;MAC7FZ,yBAAyB,CAAC,KAAK,CAAC;IAClC;EACF,CAAC,EAAE,EAAE,CAAC;EAEN7B,SAAS,CAAC,YAAM;IACd0C,QAAQ,CAACC,gBAAgB,CAAC,WAAW,EAAER,kCAAkC,CAAC;IAE1E,OAAO,YAAM;MACXO,QAAQ,CAACE,mBAAmB,CAAC,WAAW,EAAET,kCAAkC,CAAC;MAC7Eb,QAAQ,CAACP,sBAAsB,CAAC,CAAC,CAAC;IACpC,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,oBACEjB,KAAA,CAAA+C,aAAA,CAACnC,cAAc;IACboC,OAAO,EAAC,OAAO;IACfC,GAAG,EAAC,QAAQ;IACZC,SAAS,EAAC,QAAQ;IAClBC,EAAE,EAAC,kBAAkB;IACrBC,IAAI,EAAEtB,sBAAuB;IAC7BuB,OAAO,eACLrD,KAAA,CAAA+C,aAAA,CAAClC,OAAO;MACNsC,EAAE,EAAC,kBAAkB;MACrB,eAAY,mBAAmB;MAC/BG,SAAS,EAAE9C,UAAU,CAAC,kCAAkC,EAAE;QACxD,OAAO,EAAE,CAACyB,gBAAgB,IAAI,CAACC,eAAe;QAC9C,eAAe,EAAED,gBAAgB;QACjC,cAAc,EAAEC;MAClB,CAAC;IAAE,gBAEHlC,KAAA,CAAA+C,aAAA;MAAKQ,GAAG,EAAE9B;IAAW,gBACnBzB,KAAA,CAAA+C,aAAA,CAAClC,OAAO,CAAC2C,KAAK;MAACC,EAAE,EAAC,IAAI;MAACH,SAAS,EAAC;IAA8F,GAC5H/B,IAAI,CAACmC,aAAa,CAACrC,QAAQ,CAACsC,iBAAiB,CAAC,eAC/C3D,KAAA,CAAA+C,aAAA,CAACrC,IAAI;MAACkD,GAAG,EAAE7C,QAAS;MAACuC,SAAS,EAAC,cAAc;MAAC,eAAY;IAAc,CAAE,CAC7D,CAAC,eAChBtD,KAAA,CAAA+C,aAAA,CAAClC,OAAO,CAACgD,OAAO;MAACP,SAAS,EAAC;IAA0B,gBACnDtD,KAAA,CAAA+C,aAAA,CAAC3B,gBAAgB,MAAE,CACJ,CACd,CACE;EACT,gBAEFpB,KAAA,CAAA+C,aAAA;IAAKQ,GAAG,EAAE7B;EAAU,gBAClB1B,KAAA,CAAA+C,aAAA,CAACpC,UAAU;IACTmD,QAAQ,EAAEhC,sBAAuB;IACjCiC,GAAG,EAAC,wBAAwB;IAC5BC,OAAO,EAAE7B,oBAAqB;IAC9ByB,GAAG,EAAE9C,iBAAkB;IACvBmD,MAAM,EAAEvD,IAAK;IACbwD,OAAO,EAAC,OAAO;IACfC,cAAc,EAAC,kBAAkB;IACjCb,SAAS,EAAC,oCAAoC;IAC9C,eAAY;EAAwB,CACrC,CAAC,EACD,CAAAtB,kBAAkB,aAAlBA,kBAAkB,uBAAlBA,kBAAkB,CAAEoC,KAAK,IAAG,CAAC,iBAC5BpE,KAAA,CAAA+C,aAAA,CAACtC,KAAK;IACJ4D,IAAI;IACJH,OAAO,EAAC,QAAQ;IAChBZ,SAAS,EAAC,4CAA4C;IACtD,eAAY;EAAoB,GAE/BtB,kBAAkB,CAACoC,KACf,CAEN,CACS,CAAC;AAErB,CAAC;AAED,eAAe9C,aAAa"}